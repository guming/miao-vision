# 功能评估与路线图 - Miaoshou Vision vs Evidence.dev

**评估日期**: 2025-12-05
**当前版本**: Alpha (核心功能原型)

---

## 📊 现有功能清单

### ✅ 已实现核心功能

#### 1. Markdown 报告系统
- ✅ YAML front matter 支持（元数据定义）
- ✅ 变量插值（`{title}`, `{author}` 等）
- ✅ Markdown → HTML 渲染
- ✅ Monaco 代码编辑器集成
- ✅ 实时预览（双栏布局）

#### 2. SQL 执行引擎
- ✅ DuckDB-WASM 集成
- ✅ 本地 CSV 文件导入
- ✅ SQL 查询执行
- ✅ 结果表格展示
- ✅ 执行进度显示
- ✅ 错误处理

#### 3. 数据可视化
- ✅ Mosaic vgplot 集成
- ✅ Chart 类型：bar, line, scatter
- ✅ SQL → Chart 自动数据链接
- ✅ 简化的 Chart 配置语法
- ✅ 内联位置渲染（通过 placeholder 系统）

#### 4. 报告管理
- ✅ 创建/保存/加载报告
- ✅ localStorage 持久化
- ✅ 报告列表显示
- ✅ 重命名/删除/复制报告
- ✅ 最后修改时间追踪

#### 5. 核心架构
- ✅ Svelte 5 Runes 响应式系统
- ✅ Placeholder 注入系统（inline rendering）
- ✅ Table mapping（SQL 结果到 Chart 数据）
- ✅ 编辑后自动清除旧结果

---

## 🎯 Evidence.dev 核心功能对比

### ⭐ Evidence.dev 的核心优势

#### A. 数据源管理
| 功能 | Evidence.dev | Miaoshou Vision | 差距 |
|------|--------------|-----------------|------|
| 多数据源支持 | ✅ PostgreSQL, BigQuery, Snowflake, etc. | ❌ 仅 CSV 导入 | 🔴 大 |
| 数据源配置 | ✅ sources.yaml | ❌ 无 | 🔴 大 |
| 连接管理 | ✅ 环境变量支持 | ❌ 无 | 🔴 大 |
| 数据缓存 | ✅ 自动缓存 | ❌ 无 | 🟡 中 |

#### B. 组件生态
| 功能 | Evidence.dev | Miaoshou Vision | 差距 |
|------|--------------|-----------------|------|
| 内置组件 | ✅ 50+ 组件 | ❌ 仅 3 个 chart | 🔴 大 |
| BigValue | ✅ | ❌ | 🟡 中 |
| DataTable | ✅ 高级功能 | ✅ 基础表格 | 🟡 中 |
| Chart 类型 | ✅ 20+ 类型 | ✅ 3 类型 | 🟡 中 |
| 地图组件 | ✅ | ❌ | 🟡 中 |
| 输入组件 | ✅ Dropdown, TextInput, DateRange | ❌ | 🟡 中 |
| 自定义组件 | ✅ Svelte 组件 | ❌ | 🔴 大 |

#### C. 页面与导航
| 功能 | Evidence.dev | Miaoshou Vision | 差距 |
|------|--------------|-----------------|------|
| 多页面支持 | ✅ 文件夹结构 | ❌ 单页面 | 🔴 大 |
| 导航栏 | ✅ 自动生成 | ❌ 无 | 🔴 大 |
| 面包屑 | ✅ | ❌ | 🟢 小 |
| 侧边栏 | ✅ | ❌ | 🟡 中 |

#### D. 参数化与交互
| 功能 | Evidence.dev | Miaoshou Vision | 差距 |
|------|--------------|-----------------|------|
| URL 参数 | ✅ | ❌ | 🟡 中 |
| 输入控件 | ✅ | ❌ | 🟡 中 |
| 动态查询 | ✅ 参数化 SQL | ❌ 静态 SQL | 🔴 大 |
| 过滤器 | ✅ | ❌ | 🟡 中 |

#### E. 开发体验
| 功能 | Evidence.dev | Miaoshou Vision | 差距 |
|------|--------------|-----------------|------|
| 热重载 | ✅ | ✅ | ✅ 相同 |
| 错误提示 | ✅ 详细 | ✅ 基础 | 🟢 小 |
| 开发模式 | ✅ CLI 工具 | ✅ Web 界面 | 🟡 不同路线 |
| TypeScript | ✅ | ✅ | ✅ 相同 |

#### F. 部署与分享
| 功能 | Evidence.dev | Miaoshou Vision | 差距 |
|------|--------------|-----------------|------|
| 静态导出 | ✅ | ❌ | 🔴 大 |
| 云部署 | ✅ Evidence Cloud | ❌ | 🔴 大 |
| 分享链接 | ✅ | ❌ | 🔴 大 |
| 嵌入支持 | ✅ iframe | ❌ | 🟡 中 |

---

## 🚀 推荐的下一步功能（按优先级）

### 🔥 Tier 1: 核心增强（最高优先级）

#### 1.1 高级表格组件 ⭐⭐⭐⭐⭐
**价值**: 表格是数据报告的核心
**工作量**: 🟡 中等（2-3天）

功能：
- [ ] 列排序
- [ ] 分页（显示 10/50/100 行）
- [ ] 列筛选
- [ ] 列宽调整
- [ ] 导出 CSV
- [ ] 复制到剪贴板
- [ ] 数字格式化（千分位、货币、百分比）
- [ ] 条件格式化（颜色标记）

#### 1.2 更多图表类型 ⭐⭐⭐⭐⭐
**价值**: 满足常见可视化需求
**工作量**: 🟢 小（1-2天）

新增：
- [ ] Area Chart（面积图）
- [ ] Pie Chart（饼图）
- [ ] Heatmap（热力图）
- [ ] Histogram（直方图）
- [ ] Box Plot（箱线图）

优化：
- [ ] 图表配置更友好（颜色、主题）
- [ ] 图例位置可配置
- [ ] 坐标轴格式化

#### 1.3 BigValue 组件 ⭐⭐⭐⭐
**价值**: 显示关键指标（KPI）
**工作量**: 🟢 小（半天）

功能：
- [ ] 大号数字显示
- [ ] 标题和描述
- [ ] 变化趋势（↑ 5.2%）
- [ ] 颜色指示器（绿/红）
- [ ] 格式化（货币、百分比）

示例：
```markdown
```bigvalue
query: total_sales
value: sum_amount
title: Total Revenue
format: currency
comparison: last_month
```
```

---

### 🔧 Tier 2: 交互能力（高优先级）

#### 2.1 参数化查询 ⭐⭐⭐⭐
**价值**: 动态报告的核心
**工作量**: 🟡 中等（2天）

功能：
- [ ] 定义参数（在 front matter）
- [ ] 输入控件（TextInput, Dropdown, DatePicker）
- [ ] SQL 参数化（`WHERE date >= {start_date}`）
- [ ] 参数验证

示例：
```markdown
---
params:
  - name: start_date
    type: date
    default: 2025-01-01
  - name: category
    type: select
    options: [Electronics, Clothing, Food]
---

<DateInput name="start_date" />
<Dropdown name="category" />

```sql sales
SELECT * FROM sales
WHERE date >= {start_date}
AND category = {category}
```
```

#### 2.2 数据过滤器 ⭐⭐⭐
**价值**: 交互式数据探索
**工作量**: 🟡 中等（1-2天）

功能：
- [ ] 表格搜索框
- [ ] 列过滤器
- [ ] 日期范围选择
- [ ] 多选下拉菜单

---

### 📁 Tier 3: 多页面支持（中优先级）

#### 3.1 页面管理 ⭐⭐⭐
**价值**: 组织复杂报告
**工作量**: 🔴 大（3-4天）

功能：
- [ ] 文件夹结构（pages/sales/, pages/marketing/）
- [ ] 页面导航（侧边栏）
- [ ] 页面间链接
- [ ] 首页配置

#### 3.2 报告导出 ⭐⭐⭐
**价值**: 分享与发布
**工作量**: 🟡 中等（2天）

功能：
- [ ] 导出 HTML（单文件）
- [ ] 导出 PDF
- [ ] 导出 Markdown
- [ ] 包含数据快照

---

### 🗄️ Tier 4: 数据源扩展（长期）

#### 4.1 多数据源支持 ⭐⭐⭐⭐
**价值**: 连接真实数据库
**工作量**: 🔴 大（5-7天）

新增数据源：
- [ ] PostgreSQL（通过 WebSocket 代理）
- [ ] MySQL（通过 WebSocket 代理）
- [ ] REST API（fetch）
- [ ] Google Sheets（API）

注意：浏览器限制，需要代理服务器

#### 4.2 数据缓存 ⭐⭐
**价值**: 性能优化
**工作量**: 🟡 中等（1-2天）

功能：
- [ ] 查询结果缓存（IndexedDB）
- [ ] 缓存过期策略
- [ ] 手动刷新按钮

---

### 🎨 Tier 5: UI/UX 增强（持续）

#### 5.1 主题系统 ⭐⭐⭐
**价值**: 品牌定制
**工作量**: 🟡 中等（1天）

功能：
- [ ] 明/暗主题切换
- [ ] 自定义颜色方案
- [ ] 字体选择
- [ ] Logo 上传

#### 5.2 编辑体验 ⭐⭐⭐
**价值**: 开发效率
**工作量**: 🟢 小（半天）

优化：
- [ ] Markdown 语法高亮改进
- [ ] 代码补全（SQL 关键字）
- [ ] 错误下划线
- [ ] 快捷键（Cmd+S 保存）

---

## 📈 建议的实施顺序

### 第一周：核心增强
1. **BigValue 组件**（半天）- 快速见效
2. **高级表格**（2天）- 核心功能
3. **更多图表类型**（1-2天）- 丰富可视化

### 第二周：交互能力
4. **参数化查询**（2天）- 解锁动态报告
5. **数据过滤器**（1-2天）- 提升交互性

### 第三周：多页面
6. **页面管理系统**（3-4天）- 支持复杂项目

### 后续迭代
7. **数据源扩展**（按需）
8. **导出功能**（按需）
9. **主题系统**（按需）

---

## 🎯 最小可行产品（MVP）建议

如果要快速达到可用状态，建议先完成：

### MVP 必备功能（1-2周）
1. ✅ **高级表格**（排序、分页、格式化）
2. ✅ **BigValue 组件**（KPI 展示）
3. ✅ **5 种图表类型**（bar, line, area, pie, scatter）
4. ✅ **参数化查询**（基础版，TextInput + 变量替换）

### MVP Plus（额外1周）
5. ✅ **导出 HTML**（单页面报告分享）
6. ✅ **主题切换**（明/暗模式）

---

## 💡 技术债务与优化

### 当前已知问题
- ✅ Chart 第一次不显示（已修复）
- ✅ 编辑后结果不更新（已修复）
- ✅ Placeholder 系统稳定性（已修复）

### 需要优化
- [ ] 移除调试日志（生产环境）
- [ ] 错误处理统一化
- [ ] 性能：大数据集渲染优化
- [ ] 测试覆盖率（当前 0%）

---

## 🔍 与 Evidence.dev 的战略差异化

Evidence.dev 是完整的 BI 平台，我们可以选择不同定位：

### 定位 A: 轻量级本地工具
- 专注**浏览器内运行**（无需服务器）
- CSV/JSON 数据快速分析
- 适合：个人分析、数据探索、教学演示

### 定位 B: 嵌入式报告引擎
- 提供**可嵌入组件**（iframe/Web Component）
- 适合：集成到其他应用
- 适合：SaaS 产品的报告功能

### 定位 C: 离线优先 BI
- 强化**离线能力**（PWA）
- 本地数据处理（隐私优先）
- 适合：敏感数据分析

---

## ❓ 关键决策点

在开始下一步之前，需要决定：

1. **产品定位**？
   - 完整 BI 工具 vs 轻量分析工具
   - 在线协作 vs 本地单机

2. **目标用户**？
   - 数据分析师 vs 开发者 vs 普通用户
   - 技术水平要求

3. **数据源策略**？
   - 纯前端（CSV/JSON）vs 需要后端（数据库）
   - 是否需要构建代理服务器

4. **商业化**？
   - 开源免费 vs 付费功能
   - 托管服务 vs 自部署

---

**我的建议**：

如果目标是**快速做出可用产品**，我建议：

### 近期目标（2周内）
1. **高级表格** + **BigValue** + **5种图表**
2. **参数化查询**（基础版）
3. **导出 HTML**

这样就有一个**完整的单页面报告工具**，可以：
- 导入 CSV 数据
- 写 SQL 分析
- 制作精美图表
- 添加参数交互
- 导出分享

### 中期目标（1个月内）
4. **多页面支持**
5. **更多数据源**（REST API）
6. **主题系统**

---

**你的想法？**

1. 你更倾向哪个产品定位？
2. 最想要哪 3 个功能？
3. 有没有特定的使用场景？

我会根据你的反馈调整优先级！🚀
